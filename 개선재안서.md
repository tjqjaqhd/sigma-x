# SIGMA 프로젝트 개선 제안서

본 문서는 SIGMA 자동매매 시스템의 현재 구현 상태를 기반으로, 구조적 일관성, 코드 품질, 운영 효율성 향상을 위한 개선 방안을 종합적으로 제안합니다.

---

## 1. DB 접속 설정 개선

### 문제점

* `database.py` 내 DB 접속 정보가 하드코딩되어 있음

### 개선 방안

* `.env` 파일 또는 시스템 환경변수로 `DATABASE_URL` 설정
* `python-dotenv`를 사용하여 보안성과 이식성 확보

```python
import os
from dotenv import load_dotenv
load_dotenv()
DATABASE_URL = os.getenv("DATABASE_URL")
```

---

## 2. 스케줄러 통일

### 문제점

* `requirements.txt`에 `schedule`과 `apscheduler`가 중복 존재

### 개선 방안

* APScheduler만 사용하도록 통일
* `schedule`은 제거

---

## 3. 모듈 구조 분리

### 문제점

* `sigma/` 디렉토리에 모든 기능 파일이 평면적으로 배치됨

### 개선 방안

* 기능별 디렉토리 분리 구조 제안:

```
sigma/
  core/
    bot.py
    strategies.py
    execution.py
  data/
    collector.py
    models.py
  db/
    database.py
    orm_models.py
  web/
    dashboard.py
  utils/
    logger.py
```

---

## 4. 주문 실행 모듈화

### 문제점

* `TradingBot.execute_order()` 내부에 주문 로직이 직접 구현될 예정

### 개선 방안

* `OrderExecutor` 또는 `BrokerClient` 클래스로 주문 기능 위임
* TradingBot은 신호와 주문 클래스 연결만 담당

---

## 5. DB 중심 설정 구조 강화

### 문제점

* DB 중심 철학은 존재하나, `system_config`, `strategies` 등의 테이블이 실 구현되지 않음

### 개선 방안

* 설정 테이블 구조 설계 및 SQLAlchemy 모델 구현
* 실행 시점에 DB로부터 설정을 읽어오는 로직 구현

---

## 6. 로깅 및 예외 처리 강화

### 문제점

* `print()` 사용에 의존, 예외 처리 없음

### 개선 방안

* `loguru` 기반의 중앙 로깅 유틸 작성
* 각 모듈에 try-except 추가 및 오류 발생 시 슬랙 알림 연동

---

## 7. 주석 및 TODO 문서화

### 문제점

* 코드에 명확한 주석 및 계획(TODO)이 부족

### 개선 방안

* 각 함수, 클래스 상단에 목적 주석 추가
* 미구현 기능에 `# TODO:` 주석 명시

---

## 8. 테스트 및 시뮬레이션 모드 구분

### 문제점

* 실거래 모드/시뮬레이션 모드 분리 미흡

### 개선 방안

* `is_simulation` 설정값을 시스템 설정에서 불러와 모드 분기
* `OrderExecutor` 내부에서 시뮬레이션 처리 전담

---

## 9. 기능 구현 우선순위 설정

### 제안 우선 순위 (단계별 구현)

1. DB 설정 구조 구현 (`system_config`, 전략 파라미터 저장)
2. OrderExecutor 클래스 및 실거래/시뮬레이션 처리
3. 데이터 수집 모듈 및 전략 예제 추가 (예: 이평선 교차)
4. APScheduler 스케줄링 구현
5. 슬랙 알림 및 로깅 연동
6. 백테스트, 대시보드 기능 확장

---

## 10. 문서화 및 개발 가이드 제공

### 개선 방안

* 각 주요 모듈별 README 혹은 주석 기반 설명 추가
* 개발 순서와 구현 가이드를 단계별로 문서화

---

이상의 개선안은 SIGMA 시스템의 모듈화, 확장성, 유지보수성, 실전 운용 가능성을 모두 고려한 방향입니다. 초기 설계 철학(DB 중심 구조)을 유지하면서, 초보 개발자가 학습하고 기여하기 쉬운 체계를 완성하기 위해 구조적 정비를 먼저 수행하는 것을 추천합니다.
