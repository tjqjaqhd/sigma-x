# 환경 설정(DB 중심 설정 통일화) 지시 문서

## 1. 개요

SIGMA 시스템의 설정 관리가 기존 파일 기반(.env, yaml 등)에서 DB 기반(SystemConfig 테이블)으로 전면 전환되었습니다. 현재 일부 코드에서 여전히 파일 설정을 사용하거나 불필요한 환경변수를 참조하여 혼란이 발생하고 있습니다. 명확한 통일이 필요합니다.

## 2. 목표 상태

* `.env` 파일은 오직 초기 DB 접속 정보(`DATABASE_URL`) 설정 용도로만 사용합니다.
* 그 외의 모든 환경설정 정보는 `SystemConfig` 테이블에서만 관리하며, 코드 내에서는 이 테이블을 통해서만 설정을 조회합니다.
* 기존의 파일 기반 설정은 코드와 문서 모두에서 완전히 제거됩니다.

## 3. 작업 항목

| 우선순위   | 작업 내용                                                | 담당       | 예상 기간 |
| ------ | ---------------------------------------------------- | -------- | ----- |
| HIGH   | 모든 코드에서 `.env` 파일을 통해 로드하는 설정을 `DATABASE_URL` 외에는 제거 | AI Agent | 1일    |
| HIGH   | `SystemConfig` 테이블에서 모든 환경변수를 로드하도록 코드 수정            | AI Agent | 1일    |
| MEDIUM | `.env.example` 파일에서 불필요한 예시 환경변수 삭제 및 문서화 업데이트       | AI Agent | 1일    |
| MEDIUM | Alembic migration을 통해 SystemConfig 테이블의 기본 환경변수 값 명시 | AI Agent | 1일    |
| LOW    | 설정 로드 과정에서 DB 접근 로깅("Loaded config from DB") 명확히 추가  | AI Agent | 0.5일  |

## 4. 체크리스트

* [ ] 모든 코드 내에서 `.env` 참조가 `DATABASE_URL` 이외에 없음을 확인
* [ ] `SystemConfig`를 통한 설정 로드 코드가 모든 모듈에서 작동함을 확인
* [ ] Alembic 마이그레이션으로 SystemConfig 기본값이 DB에 정상적으로 기록됨을 확인
* [ ] `.env.example` 파일과 설정 문서가 업데이트되었음을 확인
* [ ] 환경 설정 로드 시 로그 메시지가 출력됨을 확인

## 5. 참고

* 기존 설정 관리 코드 위치: `config_loader.py`, `src/sigma/data/models.py`
* DB 접속 정보는 VPS 외부에서 별도 관리(부트스트랩 용도로만 유지)
